## GLSL （ OpenGL Shading Language ）

在可编程管线中我们必须要纯手写顶点和片源着色器，这里就要求必须使用 GLSL，自行编译，链接，使用。

### 变量

变量的名称可以使用字母，数字以及下划线，但变量名不能以数字开头。变量名不能以 gl\_作为前缀，这是 GLSL 保留前缀。

### 基本类型

| 数据类型         | 描述                                                                             |
| ---------------- | -------------------------------------------------------------------------------- |
| void             | 表示空类型，作为函数的返回类型，表示这个函数不返回值                             |
| bool             | 布尔类型，可以是 true 和 false,以及可以产生布尔值的表达式                        |
| int              | 整形，代表至少包含 16 位的有符号的整数。可以是十进制，十六进制，八进制           |
| float            | 浮点型                                                                           |
| bvec2            | 包含 2 个布尔成分的向量                                                          |
| bvec3            | 包含 3 个布尔成分的向量                                                          |
| bvec4            | 包含 4 个布尔成分的向量                                                          |
| ivec2            | 包含 2 个整形成分的向量                                                          |
| ivec3            | 包含 3 个整形成分的向量                                                          |
| ivec4            | 包含 4 个整形成分的向量                                                          |
| mat2 或者 mat2x2 | 2x2 的浮点数矩阵类型                                                             |
| mat3 或者 mat3x3 | 3×3 的浮点数矩阵类型                                                             |
| mat4x4           | 4x4 的浮点数矩阵类型                                                             |
| mat2x3           | 2 列 3 行的浮点矩阵（ OpenGL 的矩阵是列主顺序的 ）                               |
| mat2x4           | 2 列 4 行的浮点矩阵                                                              |
| mat3x2           | 3 列 2 行的浮点矩阵                                                              |
| mat3x4           | 3 列 4 行的浮点矩阵                                                              |
| mat4x2           | 4 列 2 行的浮点矩阵                                                              |
| mat4x3           | 4 列 3 行的浮点矩阵                                                              |
| sampler1D        | 用于内建的纹理函数中引用指定的 1D 纹理的句柄。只可以作为一致变量或者函数参数使用 |
| sampler2D        | 二维纹理句柄                                                                     |
| sampler3D        | 三维纹理句柄                                                                     |
| samplerCube      | cube map 纹理句柄                                                                |
| sampler1DShadow  | 一维深度纹理句柄                                                                 |
| sampler2DShadow  | 二维深度纹理句柄                                                                 |

### 结构体

结构体可以组合基本类型和数组来形成用户自定义的类型。在定义一个结构体的同时，可以定义一个结构体实例。或后面来定义。

`=` 为结构体赋值
`==`, `!=` 来判断两个结构体是否相等。

```
mySurface = secondSurface;

mySurface == secondSurface;
```

只有结构体中的每个成分都相等，那么这两个结构体才是相等的。访问结构体内部成员使用`.`（点语法）来访问。

```
vec3 color = mySurface.color + secondSurface.color
```

结构体至少包含一个成员。 固定大小的数组也可以被包含在结构体中。GLSL 的结构体不支持嵌套定义，只有预先声明的结构体可以嵌套其中。

```
struct myStruct {
    vec3 points[3]; // 固定大小的数组是合法的
    suface surf; // 可以，之前已定义了
    struct velocity {  // 不合法 float speed
        vec3 direction;
    } velo;
}

subSurface sub; // 不合法，没有预选声明

struct subSurface {
    int id
} ID

```

### 数组

GLSL 中只可以使用一维数组。数组的类型可以是一切基本类型或结构体。下面几种数组声明是合法的：

```
1. vec4 lightPositions[8];

2. lightPos[] = lightPositions;const int numSurface = 5;

3. suface myFiveSurface[numSurfaces];float[5] values;
```

指定显示大小的数组可以作为函数的参数或者是返回值，也可以作为结构体的成员。数组类型内建了一个 length()函数，返回长度。

`lightPositions.length()` // 返回数组的大小 8

最后，不能定义数组的数组.

### 修饰符

变量的声明可以使用如下的修饰符。

| 修饰符    | 描述                                                                                                                                                                                                  |
| --------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| const     | 常量值必须在声明的是初始化。它是只读                                                                                                                                                                  |
| attribute | 表示只读的定点数据，只用在定点着色器中。数据来自当前的定点状态或者定点数组。它必须是全局范围声明的，不能再函数内部。一个 atrrubute 可以是浮点数类型的标量，向量，或者矩阵。不可以是数组或者是结构体。 |
